

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>3.3. Transfer functions &#8212; Digital Signals Theory</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.4. Stability, poles, and zeros" href="PoleZero.html" />
    <link rel="prev" title="3.2. Properties of the z-transform" href="zT-Properties.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/dstlogo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Digital Signals Theory</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Preface
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Part 1, Signals and systems
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../ch01-signals/Intro.html">
   1. Signals
  </a>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch01-signals/Preliminaries.html">
     1.1. Preliminaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch01-signals/Waves.html">
     1.2. Periodicity and waves
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch01-signals/Units.html">
     1.3. Units and dimensional analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch01-signals/Acoustics.html">
     1.4. Audio and signals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch01-signals/Exercises.html">
     1.5. Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch02-sampling/intro.html">
   2. Digital sampling
  </a>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch02-sampling/Sampling.html">
     2.1. Sampling period and rate
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch02-sampling/Aliasing.html">
     2.2. Aliasing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch02-sampling/Nyquist.html">
     2.3. The Nyquist-Shannon sampling theorem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch02-sampling/Quantization.html">
     2.4. Quantization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch02-sampling/Exercises.html">
     2.5. Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch03-convolution/intro.html">
   3. Convolution
  </a>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch03-convolution/Building.html">
     3.1. Delay, gain, and mix
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch03-convolution/Convolution.html">
     3.2. Defining convolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch03-convolution/IR.html">
     3.3. Impulse Response
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch03-convolution/Modes.html">
     3.4. Convolution modes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch03-convolution/Properties.html">
     3.5. Properties of convolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch03-convolution/LSI.html">
     3.6. Linearity and Shift-invariance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch03-convolution/Exercises.html">
     3.7. Exercises
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Part 2, The frequency domain
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../ch04-fourier/intro.html">
   1. The Discrete Fourier Transform
  </a>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch04-fourier/Similarity.html">
     1.1. Similarity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch04-fourier/Cosine.html">
     1.2. Comparing to sinusoids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch04-fourier/AnalysisFrequencies.html">
     1.3. Analysis frequencies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch04-fourier/Phase.html">
     1.4. Phase
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch04-fourier/DFT.html">
     1.5. The Discrete Fourier Transform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch04-fourier/Examples.html">
     1.6. Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch04-fourier/SummingSinusoids.html">
     1.7. Summing sinusoids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch04-fourier/Exercises.html">
     1.8. Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch05-dft-properties/intro.html">
   2. Properties of the DFT
  </a>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch05-dft-properties/Linearity.html">
     2.1. Linearity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch05-dft-properties/Shifting.html">
     2.2. The DFT shifting theorem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch05-dft-properties/Conjugate-Symmetry.html">
     2.3. Conjugate Symmetry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch05-dft-properties/Leakage.html">
     2.4. Spectral leakage and windowing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch05-dft-properties/Exercises.html">
     2.5. Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch06-inverse-dft/intro.html">
   3. DFT Invertibility
  </a>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch06-inverse-dft/InverseDFT.html">
     3.1. The Inverse DFT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch06-inverse-dft/Exercises.html">
     3.2. Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch07-fft/intro.html">
   4. Fast Fourier Transform
  </a>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch07-fft/DFT-Analysis.html">
     4.1. Time-analysis of the DFT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch07-fft/FFT.html">
     4.2. Radix-2 Cooley-Tukey
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch07-fft/Exercises.html">
     4.3. Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch08-stft/intro.html">
   5. Time-frequency representation
  </a>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch08-stft/Framing.html">
     5.1. Framing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch08-stft/STFT.html">
     5.2. The Short-time Fourier Transform (STFT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch08-stft/Exercises.html">
     5.3. Exercises
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Part 3, Filtering
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../ch09-convtheorem/intro.html">
   1. Frequency domain convolution
  </a>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch09-convtheorem/ConvolutionTheorem.html">
     1.1. The Convolution Theorem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch09-convtheorem/Filtering.html">
     1.2. Convolutional Filtering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch09-convtheorem/FilterDesign.html">
     1.3. Filter Design and Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch09-convtheorem/Phase.html">
     1.4. Phase and group delay
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch09-convtheorem/Exercises.html">
     1.5. Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ch10-iir/intro.html">
   2. Infinite impulse response filters
  </a>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch10-iir/Feedback.html">
     2.1. Feedback filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch10-iir/UsingIIR.html">
     2.2. Using IIR filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch10-iir/IIRFilters.html">
     2.3. Common IIR filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch10-iir/Exercises.html">
     2.4. Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="intro.html">
   3. Analyzing IIR filters
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="ZT.html">
     3.1. The z-transform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="zT-Properties.html">
     3.2. Properties of the z-transform
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     3.3. Transfer functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="PoleZero.html">
     3.4. Stability, poles, and zeros
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Exercises.html">
     3.5. Exercises
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/Fundamentals.html">
   1. Mathematical fundamentals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/Complex.html">
   2. Complex numbers
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../zzzbibliography.html">
   1. References
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/content/ch11-ztransform/Transfer.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-a-transfer-function">
   3.3.1. Defining a transfer function
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-transfer-functions">
   3.3.2. Using transfer functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-analyzing-a-butterworth-filter">
     3.3.2.1. Example: analyzing a Butterworth filter
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-phase-response-of-an-elliptic-filter">
     3.3.2.2. Example: phase response of an elliptic filter
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-not-use-the-dtft">
   3.3.3. Why not use the DTFT?
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="transfer-functions">
<h1><span class="section-number">3.3. </span>Transfer functions<a class="headerlink" href="#transfer-functions" title="Permalink to this headline">¶</a></h1>
<div class="math notranslate nohighlight">
\[
\require{color}\notag%
\]</div>
<p>When we previously analyzed FIR filters, it became useful to examine the discrete Fourier transform <span class="math notranslate nohighlight">\(H[m]\)</span> of the impulse response <span class="math notranslate nohighlight">\(h[k]\)</span>.
The frequency domain view of convolutional filters immediately exposes how a filter will delay and gain (or attenuate) different frequencies.
However, as noted earlier in this chapter, the DFT cannot be applied directly to feedback systems with infinite impulse responses, and this led to our derivation of the z-Transform.</p>
<p>In this section, we’ll return to our initial motivation, and derive something similar to <span class="math notranslate nohighlight">\(H[m]\)</span>, except from the perspective of the z-Transform rather than the DFT.
The resulting object is known as the <em>transfer function</em> of a filter, and is denoted by <span class="math notranslate nohighlight">\(H(z)\)</span>.</p>
<div class="cell tag_remove_input tag_remove_output docutils container">
</div>
<div class="section" id="defining-a-transfer-function">
<h2><span class="section-number">3.3.1. </span>Defining a transfer function<a class="headerlink" href="#defining-a-transfer-function" title="Permalink to this headline">¶</a></h2>
<p>Let’s start with a linear IIR filter in standard form:</p>
<div class="math notranslate nohighlight">
\[a[0] \cdot y[n] = \sum_{k=0}^{K-1} b[k] \cdot x[n-k] - \sum_{k=1}^{K-1} a[k] \cdot y[n-k],\]</div>
<p>where <span class="math notranslate nohighlight">\(b[k]\)</span> and <span class="math notranslate nohighlight">\(a[k]\)</span> denote the feed-forward and feed-back coefficients of the filter.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>This is the point where the benefit of including <span class="math notranslate nohighlight">\(a[0]\)</span> and subtracting the feedback terms (rather than adding them) pays off.
<a class="reference internal" href="#equation-conv-sym">(3.15)</a> would have been much more awkward without <span class="math notranslate nohighlight">\(a[0]\)</span> and the correct sign on the feedback terms!</p>
</div>
<p>If we move all feedback terms to the left-hand side of the equation, we obtain an equivalent equation:</p>
<div class="math notranslate nohighlight" id="equation-diff-sym">
<span class="eqno">(3.14)<a class="headerlink" href="#equation-diff-sym" title="Permalink to this equation">¶</a></span>\[\sum_{k=0}^{K-1} a[k] \cdot y[n-k] = \sum_{k=0}^{K-1} b[k] \cdot x[n-k].\]</div>
<p>While this form is not useful for computing <span class="math notranslate nohighlight">\(y\)</span>, it is useful for analyzing <span class="math notranslate nohighlight">\(y\)</span>!</p>
<p>In particular, you might recognize that both sides of the equation are convolutions:</p>
<div class="math notranslate nohighlight" id="equation-conv-sym">
<span class="eqno">(3.15)<a class="headerlink" href="#equation-conv-sym" title="Permalink to this equation">¶</a></span>\[a*y = b*x.\]</div>
<p>This means that if we take the z-transform of both sides, we can use the z-transform convolution theorem:</p>
<div class="math notranslate nohighlight">
\[A(z) \cdot Y(z) = B(z) \cdot X(z),\]</div>
<p>where <span class="math notranslate nohighlight">\(A(z), Y(z), B(z), X(z)\)</span> denote the z-transforms of <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, and <span class="math notranslate nohighlight">\(x\)</span> respectively.</p>
<p>As long as <span class="math notranslate nohighlight">\(A(z)\)</span> is not zero — and it generally is non-zero except for at most <span class="math notranslate nohighlight">\(K\)</span> specific choices of <span class="math notranslate nohighlight">\(z\)</span> — we can divide through to isolate <span class="math notranslate nohighlight">\(Y(z)\)</span>:</p>
<div class="math notranslate nohighlight">
\[Y(z) = \frac{B(z)}{A(z)} \cdot X(z).\]</div>
<p>This gives us something highly reminiscent of the convolution theorem: filtering in the time domain has again be expressed as multiplication, except now in the <span class="math notranslate nohighlight">\(z\)</span>-plane instead of the frequency domain.</p>
<div class="admonition-definition-transfer-function admonition">
<p class="admonition-title">Definition: transfer function</p>
<p>Let <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> denote the feed-back and feed-forward coefficients of a linear IIR filter:</p>
<div class="math notranslate nohighlight">
\[a[0] \cdot y[n] = \sum_{k=0}^{K-1} b[k] \cdot x[n-k] - \sum_{k=1}^{K-1} a[k] \cdot y[n-k].\]</div>
<p>The <strong>transfer function</strong> of this filter is defined as follows</p>
<div class="math notranslate nohighlight" id="equation-transfer-function">
<span class="eqno">(3.16)<a class="headerlink" href="#equation-transfer-function" title="Permalink to this equation">¶</a></span>\[H(z) = \frac{B(z)}{A(z)} = \frac{\sum_{k=0}^{K-1} b[k] \cdot z^{-k}}{\sum_{k=0}^{K-1} a[k] \cdot z^{-k}}\]</div>
</div>
</div>
<div class="section" id="using-transfer-functions">
<h2><span class="section-number">3.3.2. </span>Using transfer functions<a class="headerlink" href="#using-transfer-functions" title="Permalink to this headline">¶</a></h2>
<p>As mentioned previously, transfer functions can be thought of as providing a generalization of the convolution theorem to support feedback filters.
Specifically, we have</p>
<div class="math notranslate nohighlight" id="equation-transfer-theorem">
<span class="eqno">(3.17)<a class="headerlink" href="#equation-transfer-theorem" title="Permalink to this equation">¶</a></span>\[Y(z) = H(z) \cdot X(z) = \frac{B(z)}{A(z)} \cdot X(z).\]</div>
<p>Note that as a special case, if <span class="math notranslate nohighlight">\(a = [1]\)</span> (so that there is no feedback in the filter), we get the z-transform</p>
<div class="math notranslate nohighlight">
\[A(z) = \sum_{k=0}^\infty a[k] \cdot z^{-k}= a[0] \cdot z^{0} = a[0] = 1.\]</div>
<p>In this case, the transfer function simplifies to <span class="math notranslate nohighlight">\(H(z) = B(z) / 1 = B(z)\)</span>, and we recover the convolution theorem.</p>
<p>More generally, we can still reason about <span class="math notranslate nohighlight">\(H(z)\)</span> as the object that transforms the input signal <span class="math notranslate nohighlight">\(x\)</span> into the output signal <span class="math notranslate nohighlight">\(y\)</span>.
Evaluating <span class="math notranslate nohighlight">\(H(z)\)</span> at values of <span class="math notranslate nohighlight">\(z\)</span> with unit magnitude — i.e. <span class="math notranslate nohighlight">\(z= e^{\mathrm{j}\cdot \theta}\)</span> — produces the <em>frequency response</em> of the filter.
In Python, this is provided by the function <code class="docutils literal notranslate"><span class="pre">scipy.signal.freqz</span></code> (frequency response via z-transform).</p>
<div class="section" id="example-analyzing-a-butterworth-filter">
<h3><span class="section-number">3.3.2.1. </span>Example: analyzing a Butterworth filter<a class="headerlink" href="#example-analyzing-a-butterworth-filter" title="Permalink to this headline">¶</a></h3>
<p>In <a class="reference internal" href="../ch10-iir/UsingIIR.html#using-iir"><span class="std std-ref">Using IIR filters</span></a>, we constructed a Butterworth filter and rather crudely analyzed its effect on an impulse input by truncating the output <span class="math notranslate nohighlight">\(y\)</span> and taking the DFT.
Let’s revisit this example, but instead analyze it using the z-transform and transfer functions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="mi">44100</span>  <span class="c1"># 44.1K sampling rate</span>
<span class="n">fc</span> <span class="o">=</span> <span class="mi">500</span>    <span class="c1"># 500 Hz cutoff frequency</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># order-10 filter</span>

<span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">fc</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">freq</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
<p>The result of this computation is an array <code class="docutils literal notranslate"><span class="pre">freq</span></code> of frequencies (spaced uniformly between <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">fs/2</span></code>), and an array <code class="docutils literal notranslate"><span class="pre">H</span></code> that evaluates the transfer function at each specified frequency.</p>
<div class="margin sidebar">
<p class="sidebar-title">How many frequencies?</p>
<p>By default, scipy’s <code class="docutils literal notranslate"><span class="pre">freqz</span></code> uses <code class="docutils literal notranslate"><span class="pre">worN=512</span></code> frequencies (up to, but not including Nyquist), but this can be easily changed to whatever frequency resolution you prefer.
Often, we are only using <code class="docutils literal notranslate"><span class="pre">freqz</span></code> to support a visual inspection of the frequency response, and for that use case, 512 frequencies is typically sufficient.</p>
</div>
<p>The figure below illustrates the response curve by plotting <code class="docutils literal notranslate"><span class="pre">freq</span></code> on the horizontal axis and <code class="docutils literal notranslate"><span class="pre">abs(h)</span></code> (in decibel scale) on the vertical axis, i.e.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Convert |H| to decibels, with a -120dB noise floor</span>
<span class="n">H_dB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">H_dB</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_remove_output tag_remove_input docutils container">
</div>
<div class="figure align-default" id="id1">
<div class="cell_output docutils container">
<img alt="../../_images/Transfer_6_0.svg" src="../../_images/Transfer_6_0.svg" /></div>
<p class="caption"><span class="caption-number">Fig. 3.13 </span><span class="caption-text">The frequency response curve <span class="math notranslate nohighlight">\(|H(z)|\)</span> for an order-10 Butterworth filter with a cutoff frequency at <span class="math notranslate nohighlight">\(f_c=500\)</span> Hz and sampling rate <span class="math notranslate nohighlight">\(f_s=44100\)</span>.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>Note that we never had to construct a test signal to generate this curve: all of the information was inferred from the filter coefficients <code class="docutils literal notranslate"><span class="pre">b</span></code> and <code class="docutils literal notranslate"><span class="pre">a</span></code>!</p>
</div>
<div class="section" id="example-phase-response-of-an-elliptic-filter">
<span id="elliptic-transfer"></span><h3><span class="section-number">3.3.2.2. </span>Example: phase response of an elliptic filter<a class="headerlink" href="#example-phase-response-of-an-elliptic-filter" title="Permalink to this headline">¶</a></h3>
<p>Just like with convolutional filters, we can infer delay properties of IIR filters by looking at the phase spectrum contained in <span class="math notranslate nohighlight">\(H(z)\)</span>.
This can be done directly, e.g., by calling <code class="docutils literal notranslate"><span class="pre">scipy.signal.freqz</span></code> and then using <code class="docutils literal notranslate"><span class="pre">np.unwrap(np.angle(h))</span></code> to compute the unwrapped phase.
Alternatively, it is usually more convenient to use the already provided <code class="docutils literal notranslate"><span class="pre">group_delay</span></code> function, as demonstrated below for an elliptic filter.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="mi">44100</span>  <span class="c1"># Sampling rate</span>
<span class="n">fc</span> <span class="o">=</span> <span class="mi">500</span>  <span class="c1"># Cutoff frequency</span>
<span class="n">fstop</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">attenuation</span> <span class="o">=</span> <span class="mi">40</span>  <span class="c1"># we&#39;ll require 80 dB attenuation in the stop band</span>
<span class="n">ripple</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># we&#39;ll allow 3 dB ripple in the passband</span>

<span class="n">order_ell</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">ellipord</span><span class="p">(</span><span class="n">fc</span><span class="p">,</span> <span class="n">fstop</span><span class="p">,</span> <span class="n">ripple</span><span class="p">,</span> <span class="n">attenuation</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">b_ell</span><span class="p">,</span> <span class="n">a_ell</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">ellip</span><span class="p">(</span><span class="n">order_ell</span><span class="p">,</span> <span class="n">ripple</span><span class="p">,</span> <span class="n">attenuation</span><span class="p">,</span> <span class="n">wn</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="c1"># scipy&#39;s group delay measures in samples</span>
<span class="c1"># we&#39;ll convert to seconds by dividing out the sampling rate</span>
<span class="n">freq</span><span class="p">,</span> <span class="n">delay</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">group_delay</span><span class="p">([</span><span class="n">b_ell</span><span class="p">,</span> <span class="n">a_ell</span><span class="p">],</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">delay_sec</span> <span class="o">=</span> <span class="n">delay</span> <span class="o">/</span> <span class="n">fs</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">scipy.signal.group_delay</span></code> returns the delay for each measured frequency in <code class="docutils literal notranslate"><span class="pre">freq</span></code> in units of <code class="docutils literal notranslate"><span class="pre">[samples]</span></code>.
To convert the delay measurements to <code class="docutils literal notranslate"><span class="pre">[seconds]</span></code>, we divide by the sampling rate <code class="docutils literal notranslate"><span class="pre">fs</span></code>.
A visualization of the resulting group delay (along with the frequency response) is provided below.</p>
<div class="cell tag_remove_output tag_remove_input docutils container">
</div>
<div class="figure align-default" id="ellipanalysis">
<div class="cell_output docutils container">
<img alt="../../_images/Transfer_9_0.svg" src="../../_images/Transfer_9_0.svg" /></div>
<p class="caption"><span class="caption-number">Fig. 3.14 </span><span class="caption-text">The frequency response curve <span class="math notranslate nohighlight">\(|H(z)|\)</span> (<em>top</em>) and phase response curve (group delay, <em>bottom</em>) for an elliptic filter with cutoff <span class="math notranslate nohighlight">\(f_c=500\)</span>, transition bandwidth of 100 Hz, 3dB passband ripple, and 40dB stop-band attenuation (<span class="math notranslate nohighlight">\(f_s=44100\)</span>).
The plot is limited to the frequency range [0, 2000] so that the trends within the passband are easier to see.</span><a class="headerlink" href="#ellipanalysis" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="why-not-use-the-dtft">
<h2><span class="section-number">3.3.3. </span>Why not use the DTFT?<a class="headerlink" href="#why-not-use-the-dtft" title="Permalink to this headline">¶</a></h2>
<p>Everything we’ve done so far only depends on <span class="math notranslate nohighlight">\(z\)</span> with unit magnitude: frequency response and phase response are both properties of <span class="math notranslate nohighlight">\(H\left(e^{j\cdot \theta}\right)\)</span>, which we can think of as computing the discrete-time Fourier transform (DTFT).
At this point, it is completely reasonable to wonder why we needed to define the z-transform to support any complex number <span class="math notranslate nohighlight">\(z\)</span>, instead of just those points on the unit circle.</p>
<p>As we will see in the next section, expanding the definition to include all complex <span class="math notranslate nohighlight">\(z\)</span> allows us to study the <em>stability</em> of a filter, and this would not be possible with just the DTFT.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "bloody"
        },
        kernelOptions: {
            kernelName: "bloody",
            path: "./content/ch11-ztransform"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'bloody'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="zT-Properties.html" title="previous page"><span class="section-number">3.2. </span>Properties of the z-transform</a>
    <a class='right-next' id="next-link" href="PoleZero.html" title="next page"><span class="section-number">3.4. </span>Stability, poles, and zeros</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Brian McFee<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-89057641-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>